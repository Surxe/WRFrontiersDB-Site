---
import { getParseObjects } from '../utils/parse_object';
import LocalizedText from './LocalizedText.astro';

export interface Props {
  parseObjectFile: string;
  parseObjectUrl: string;
  version: string;
  prodReadyOnly?: boolean;
}

const { parseObjectFile, parseObjectUrl, version, prodReadyOnly = false } = Astro.props;

const objects = getParseObjects(parseObjectFile, version);
let entries = Object.entries(objects);

if (prodReadyOnly) {
  entries = entries.filter(([_, obj]) => obj.production_status === 'Ready');
}

const items = entries.map(([id, _]) => ({
  id,
  url: `/WRFrontiersDB-Site/${parseObjectUrl}/${id}/${version}`
}));

// Creates list of links to parse objects. Not to be confused with a ParseObjectListPage, which is a full page wrapper.
---

<ul>
  {items.map(({ id, url }) => (
    <li>
      <a href={url}>
        <LocalizedText
          tag="span"
          localizationKey={objects[id].name}
        />
      </a>
    </li>
  ))}
</ul>