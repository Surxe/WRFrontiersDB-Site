---
import ObjRef from '../obj_ref/ObjRef.astro';
import type { PilotTalentType } from '../../types/pilot';
import { getParseObjects } from '../../utils/parse_object';

interface Props {
  levelIndex: number; // 0 for level 1, 1 for level 2, 2 for level 3, 3 for level 4, 4 for level 5
  level?: {
    talents?: string[];
    talent_type_id?: string;
  };
  talentIndex: number;
  maxTalents: number;
  version: string;
}

/*
Create table data cells that look like this for the respective levels:
Level 1-4:
TalentType1
TalentType2
TalentType3

Level 5: 
TalentType1 (rowspan=maxTalents)

To summarize: Levels 1-4 have 3 talents, level 5 has 1 talent. 
*/

const { levelIndex, level, talentIndex, maxTalents, version } = Astro.props;

const pilotTalentTypes = getParseObjects<PilotTalentType>(
  'Objects/PilotTalentType.json',
  version
);
---

{/* Talent column */}
{/* For level 5, use rowspan and only render on first talent row */}
{/* For levels 1 and 2-4, render for each talent index */}

{talentIndex === 0 && (
  <td rowspan={maxTalents}>
    {level?.talent_type_id && (
      <ObjRef
        obj={pilotTalentTypes[level.talent_type_id]}
        version={version}
      />
    )}
  </td>
)}